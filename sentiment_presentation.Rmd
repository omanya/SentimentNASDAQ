---
title: "'Buy on rumor, sell on news'"
subtitle: "the effect of news arrivals and investor sentiment on the distribution of excess returns"
author: Maria Osipenko^[Hochschule für Wirtschaft und Recht Berlin; osipenko@hwr-berlin.de], Rui Ren^[Humboldt-Universität zu Berlin]
date: "`r format(Sys.time(), '%d %B, %Y')`"
fontsize: 10pt
output: 
 beamer_presentation:
 keep_tex: true
 toc: true
 slide_level: 3
 includes:
  in_header: ~/mbeamer_setup.txt
  after_body: ~/content_tab.txt
header-includes:
- \usepackage{amstext}
- \usepackage{amsmath}
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{array}
- \usepackage{multirow}
- \usepackage{wrapfig}
- \usepackage{float}
- \usepackage{colortbl}
- \usepackage{pdflscape}
- \usepackage{tabu}
- \usepackage{threeparttable}
- \usepackage{threeparttablex}
- \usepackage[normalem]{ulem}
- \usepackage{makecell}
- \usepackage{xcolor}
bibliography: references.bib   

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Intro

- Good news? Bad news?! News!!!
- Sentiment matters, but not for the mean: evidence in @Ma2018 and @ALNASSERI2021
- Simple versus complex: does it pay up to use machine learning sentiment measures with high complexity?

$\rightarrow$ estimate distributional effect of news arrivals and sentiment using expectile regression.

## Data

- Excess returns for 100 NASDAQ stocks, time span 201501-201909
- sentiment:
  - "the rumor": use btm ratios as proxies of earnings expectations
  - "the news": consider the event of new arrival and the tone of the news text separately
  - "the sentiment": use LM and Harvard dictionaries (simple) and randomforest with FinBert (complex)
- other variables: size, alpha, turnover, nasdaq indicator.

## Mean regression with random effects

- standard panel data model for the excess returns ($r_{i,t}$) of $n$ stocks over $t=1,\ldots, T$ and $i=1,\ldots,n$: \[r_{i,t} = x_{i,t}^\top\beta + u_i + v_{i,t}\] with 
  - $r_{i,t}$ excess return of stock $i$ at time $t$, 
  - $x_{i,t}$ a vector of $p$ predictors (including the constant term) known at time $t$, 
  - $u_i$ is unobserved random individual effect, 
  - $v_{i,t}$ an error term uncorrelated with $x_{i,t}$ and $v_{i,t}$.

## Expectile regression with random effects (ERRE)

- Conditional expectile regression with random effects (@BARRY2016) aims to estimate the $\tau$-expectile:

\[e_\tau(r_{i,t})  = x_{i,t}^\top \beta_\tau, i=1,\ldots, n, t=1,\ldots T,\]

where $\tau\in (0,1)$ is the expectile level.

- The estimator minimizes the expectile loss function:

\[\arg\min_{\beta\in\mathbb R^p}\frac 1n\sum_{i=1}^n\sum_{t=1}^T\rho_\tau\Big(r_{i,t} - x_{i,t}\beta(\tau)\Big)\]

with $\rho_\tau(y)=|\tau - \mathbf 1(y<0)|y^2$ is the expectile check function.

## Expectile regression with random effects (ERRE)


- The resulting estimator has the form:
\[\hat\beta_\tau = \Big(\sum_{i=1}^n\sum_{t=1}^T\hat w_{i,t} (\tau)x_{i,t}x_{i,t}^\top\Big)^{-1}\Big(\sum_{i=1}^n\sum_{t=1}^T\hat w_{i,t} (\tau)x_{i,t}r_{i,t}\Big)\]

with $\hat w_{i,t}(\tau) = |\tau - \mathbf 1(r_{i,t}\leq x_{i,t}\hat\beta(\tau))|$

and can be computed via *iterative weighted asymmetric least squares*.

## ERRE with LM sentiment: the Model

Our first model specification is:

\begin{align}
e_\tau(r_{i,t}) &= \beta_{0,\tau} + \beta_{1,\tau}\cdot \log(size_{i,t}) + \beta_{2,\tau} \cdot btm_{i,t-1} + \beta_{3,\tau}\cdot turn_{i,t-1}\\\nonumber
&+\beta_{4,\tau}\cdot alpha_{i,t}+\beta_{5,\tau}\cdot nq_{i,t} + \beta_{6,\tau}\cdot news_{i,t} + \beta_{7,\tau}\cdot lm\_tone_{i,t}
\end{align}

<!-- - $r_{i,t}$ the excess return of equity $i$ at time $t$, computed as ... -->

<!-- - $\log(size_{i,t})$ the logarithm of the size? of the company  -->

<!-- - $turn_{i,t}$ turnover -->

<!-- - $btm_{i,t-1}$ the book-to-market ratio if $i$ in $t-1$ -->

<!-- - $alpha_{i,t}$ @FAMA1992 alpha computed based on the past returns (?) -->

<!-- - $nq_{i,t}$ indicator whether company $i$ is listed on NASDAQ -->
 
- $news_{i,t}$ indicator whether a news report referred to company $i$ has been released at $t$
 
- $lm\_tone_{i,t}$ is news sentiment computed as $\frac{\#\text{ of positive words} - \# \text{ of negative words}}{\#\text{ of positive words}+\# \text{ of negative words}}$ using the LM dictionary.
 


```{r, echo=FALSE}
source("myfuns.R")
load("mod0.RData"); load("mod1.RData"); load("mod2.RData"); load("mod3.RData")
```


## ERRE with LM sentiment: the Results

```{r table1,echo=FALSE}
make_knitr_table_bm(mod0)
```


## ERRE with LM sentiment: the Effects

```{r figure1, fig.cap="Coefficient profiles of sentiment related variables for different $\\tau$-levels using LM dictionary based sentiment ", echo=FALSE}
effe<-"lm"# which effect is measured lm, hv, ml            
lbls<-c(bquote(btm[it-1]),bquote(news[it]), 
        bquote(.(paste0(effe,"_tone"))[it])
)
al<-0.95
wo<-c("btm1", "news","LM.TONE")
plot_eefects(mod0,which_ones=wo,lbls=lbls[1:length(wo)])

```

## How do we interpret the results?

- we observe significant changes in effects across expectile levels (btm, news)
- LM dictionary seems to capture the facetts of sentiment important for the higher expectiles (for $\tau>0.75$)
- news arrivals exhibit an effect with changing sign at aproximately $\tau=0.5$


## How do we interpret the results?

- news arrivals have a strong negative effect on low return expectiles regardless of the news tone. 
- For example, given the data, the maximum of scaled $lm\_tone$ over all days and stocks is $1$, the respective coefficient for the $5\%$-expectile on news arrivals is \(`r round(mod0$coefs["news",1],5)`(`r round(mod0$coefs["news",1]- qnorm(1-al/2)*mod0$ses["news",1],5)`, `r round(mod0$coefs["news",1]+ qnorm(1-al/2)*mod0$ses["news",1],4)`)\) and on net tone is \(`r round(mod0$coefs["LM.TONE",1],5)`(`r round(mod0$coefs["LM.TONE",1]- qnorm(1-al/2)*mod0$ses["LM.TONE",1],5)`, `r round(mod0$coefs["LM.TONE",1]+ qnorm(1-al/2)*mod0$ses["LM.TONE",1],5)`)\), so the net effect of the "best" empirical tone would calculate: 
\[`r round(mod0$coefs["news",1] + mod0$coefs["LM.TONE",1]* 1,5)` (`r round(mod0$coefs["news",1]- qnorm(1-al/2)*mod0$ses["news",1]+(mod0$coefs["LM.TONE",1]- qnorm(1-al/2)*mod0$ses["LM.TONE",1])*1,5)`,
`r round(mod0$coefs["news",1]+ qnorm(1-al/2)*mod0$ses["news",1]+(mod0$coefs["LM.TONE",1]+ qnorm(1-al/2)*mod0$ses["LM.TONE",1])*1,5)`)\]

with an asymptotic $95\%$-confidence interval given in brackets.



## How do we interpret the results?

- $\rightarrow$ in low return state also positive news can lead to a negative effect on the excess return.

- We explain this effect with the trading strategy *'Buy on rumor, sell on news'* for  low return states.
- investors buy equities with low returns when they expect their growth (btm, the 'rumor' part) and sell low return stocks to ride on the hype of (positive) news arrivals. 
- This effect can be also connected to the 'market sidedness' of @SARKAR2009: disproportionaly higher seller quote at news arrivals in case of low expectiles. 
- The positive effect of btm ratio arises as a result of buyer 'sidedness' hunting the equities with low returns but promising expected performance (high btm).

## ERRE with HV sentiment: the Model

Our second model specification is:

\begin{align}
e_\tau(r_{i,t}) &= \beta_{0,\tau} + \beta_{1,\tau}\cdot \log(size_{i,t}) + \beta_{2,\tau} \cdot btm_{i,t-1} + \beta_{3,\tau}\cdot turn_{i,t-1}\\\nonumber
&+\beta_{4,\tau}\cdot alpha_{i,t}+\beta_{5,\tau}\cdot nq_{i,t} + \beta_{6,\tau}\cdot news_{i,t} + \beta_{7,\tau}\cdot lm\_tone_{i,t}
\end{align}

- $news_{i,t}$ indicator whether a news report referred to company $i$ has been released at $t$
 
- $hv\_tone_{i,t}$ is news sentiment computed as $\frac{\#\text{ of positive words} - \# \text{ of negative words}}{\#\text{ of positive words}+\# \text{ of negative words}}$ using the Harvard dictionary.
 


## ERRE with HV sentiment: the Results

```{r table2,echo=FALSE}
make_knitr_table_bm(mod1)
```


## ERRE with HV sentiment: the Effects

```{r figure2, fig.cap="Coefficient profiles of sentiment related variables for different $\\tau$-levels using HV dictionary based sentiment ", echo=FALSE}
effe<-"hv"# which effect is measured lm, hv, ml            
lbls<-c(bquote(btm[it-1]),bquote(news[it]), 
        bquote(.(paste0(effe,"_tone"))[it])
)
wo<-c("btm1", "news","HIV4.TONE")
plot_eefects(mod1,which_ones=wo,lbls=lbls[1:length(wo)])

```

## How do we interpret the results?

- the effects of news arrivals and btm ratio are similar to the previous model.
- explanatory power of HV dictionary is lower than that of LM dictionary (as mesured by $R^2$)
- HV dictionary seems to capture the facetts of sentiment important for the lower expectiles (for $\tau<0.5$)

## ERRE with ML sentiment: the Model

Our next model specification is:

\begin{align}
e_\tau(r_{i,t}) &= \beta_{0,\tau} + \beta_{1,\tau}\cdot \log(size_{i,t}) + \beta_{2,\tau} \cdot btm_{i,t-1} + \beta_{3,\tau}\cdot turn_{i,t-1}\\\nonumber
&+\beta_{4,\tau}\cdot alpha_{i,t}+\beta_{5,\tau}\cdot nq_{i,t} + \beta_{6,\tau}\cdot news_{i,t} + \beta_{7,\tau}\cdot ml\_tone_{i,t}
\end{align}


- $ml\_tone_{i,t}$ is news sentiment defined as an out-of-sample return forecast for stock $i$ and time $t$ produced by a random forest model based on the FinBert embeddings.
 


## ERRE with ML sentiment: the Results

```{r table3,echo=FALSE}
make_knitr_table_bm(mod2)
```


## ERRE with ML sentiment: the Effects

```{r figure3, fig.cap="Coefficient profiles of sentiment related variables for different $\\tau$-levels using ML based sentiment ", echo=FALSE}
effe<-"ml"# which effect is measured lm, hv, ml            
lbls<-c(bquote(btm[it-1]),bquote(news[it]), 
        bquote(.(paste0(effe,"_tone"))[it])
)
wo<-c("btm1", "news","ML.TONE")
plot_eefects(mod2,which_ones=wo,lbls=lbls[1:length(wo)])

```

## How do we interpret the results?

- the effects of news arrivals and btm ratio are similar to the previous models.
- explanatory power of ML approach is higher than that of LM/HV dictionary (as mesured by $R^2$)
- ML tone seems to capture the facetts of sentiment important for both lower and higher expectiles (U-shape).
- $\rightarrow$ can we achieve better performance of dictionary methods by mimicing the ML approach, i.e.by combining both sentiment tones, so that important features for lower and higher expectiles are captured?

## ERRE with combined LM/HV sentiment: the Model

In this model specification we use $comb\_tone_{i,t}$ set to $(1-\tau)\cdot hv\_tone_{i,t}+ \tau\cdot lm\_tone_{i,t}$ in order to overweight $hv\_tone_{i,t}$ for low and to overweight $lm\_tone_{i,t}$ for high $\tau$-values:

\begin{align}
e_\tau(r_{i,t}) &= \beta_{0,\tau} + \beta_{1,\tau}\cdot \log(size_{i,t}) + \beta_{2,\tau} \cdot btm_{i,t-1} + \beta_{3,\tau}\cdot turn_{i,t-1}\\\nonumber
&+\beta_{4,\tau}\cdot alpha_{i,t}+\beta_{5,\tau}\cdot nq_{i,t} + \beta_{6,\tau}\cdot news_{i,t} + \beta_{7,\tau}\cdot comb\_tone_{i,t}
\end{align}



## ERRE with ML sentiment: the Results

```{r table4,echo=FALSE}
make_knitr_table_bm(mod3)
```


## ERRE with ML sentiment: the Effects

```{r figure4, fig.cap="Coefficient profiles of sentiment related variables for different $\\tau$-levels using combined LM/HV dictionary based sentiment ", echo=FALSE}
effe<-"comb"# which effect is measured lm, hv, ml            
lbls<-c(bquote(btm[it-1]),bquote(news[it]), 
        bquote(.(paste0(effe,"_tone"))[it])
)
wo<-c("btm1", "news","comb.tone")
plot_eefects(mod3,which_ones=wo,lbls=lbls[1:length(wo)])

```

## How do we interpret the results?

- The model fit is improved in terms of $R^2$. 
- the combined dictionary model still can not "beat" the machine learning approach to the sentiment tone extraction. 
- it clearly replicates the U-shape coefficient profile and is to prefer in terms of complexity and transparency/ interpretability of the results to the ML approach. 

## Conclusions

- sign change in the coefficient profiles of btm ratios and new arrivals
- also good news can lead to over-all negative effect on return for low return states.
- $\rightarrow$ "buy on rumor sell on news" strategy for low expectiles?
- the news tone is best captured by the machine learning approach.
- sentiment assement via dictionaries can be improved using a combined expectile weighted tone based on both LM and HV dictionaries.

## References

<div id="refs"></div>


